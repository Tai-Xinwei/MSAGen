defaults:
- config_psm_schema
- _self_

model_type: psm
num_classes: 1
encoder_attention_heads: 32
encoder_ffn_embed_dim: 6144
encoder_embed_dim: 1536
encoder_layers: 32
num_pred_attn_layer: 4
num_3d_bias_kernel: 128
max_length: 512
pbc_expanded_token_cutoff: 256
pbc_expanded_num_cell_per_direction: 3
multi_hop_max_dist: 5
droppath_prob: 0.0
act_dropout: 0.1
attn_dropout: 0.1
dropout: 0.0
sandwich_ln: true
noise_scale: 0.2
mask_ratio: 0.5
d_tilde: 1.0
pbc_cutoff: 20.0
data_path: /blob/psm/
dataset_names: ''
loadcheck_path: /blob/sfmexpresults/peiran/psmv1_vt_v10_1b/checkpoints/global_step103463/mp_rank_00_model_states.pt
add_3d: false
no_2d: false
ft: false
infer: false
use_pbc: false
transformer_m_pretrain: true
mode_prob: 0.4,0.4,0.2
num_timesteps: 5000
ddpm_beta_start: 1.0e-07
ddpm_beta_end: 0.002
ddpm_schedule: sigmoid
noise_mode: diff
num_edges: 1536
num_atom_features: 5120
attention_dropout: 0.0
share_encoder_input_output_embed: false
encoder_learned_pos: false
no_token_positional_embeddings: false
num_segments: 2
sentence_class_num: 2
sent_loss: false
apply_bert_init: false
activation_fn: relu
pooler_activation_fn: tanh
encoder_normalize_before: false
atom_loss_coeff: 1.0
pos_loss_coeff: 1.0
y_2d_loss_coeff: 1.0
max_positions: 512
num_atoms: 4608
num_in_degree: 512
num_out_degree: 512
num_spatial: 512
num_edge_dis: 128
edge_type: multi_hop
layerdrop: 0.0
apply_graphormer_init: true
pre_layernorm: false
seq_masking_method: transformerM
add_rope: true
num_residues: 32
max_num_aa: 1024
encoder_pair_embed_dim: 64
decoder_ffn_dim: 1024
task: mae
sample_mode: false
train_data_path: ''
valid_data_path: ''
data_path_list: PubChemQC-B3LYP-PM6,matter-sim-15M-force-filtered-merged,AFDB70-plddt70.lmdb,matter-sim-15M-merged,ur50_23_bpe_pack1536.lmdb
dataset_name_list: pm6,mattersim,afdb,mattersim,ur50
dataset_split_raito: 0.2,0.1,0.5,0.1,0.1
dataset_micro_batch_size: 64,8,8,8,2
lamb_pde: 0.01
mode: score
pbc_expanded_distance_cutoff: 20.0
pbc_use_local_attention: false
pbc_multigraph_cutoff: 5.0
diff_init_lattice_size: 10.0
lattice_size: 4.0
diffusion_sampling: ddpm
diffusion_mode: epsilon
diffusion_noise_std: 10.0
ddim_eta: 0.0
ddim_steps: 50
clean_sample_ratio: 0.2
diffusion_training_loss: L1
diffusion_time_step_encoder_type: POSITIONAL
equivar_vec_init: RELATIVE_POS
equivar_use_linear_bias: false
equivar_use_attention_bias: false
use_2d_atom_features: true
use_2d_bond_features: false
preprocess_2d_bond_features_with_cuda: true
use_memory_efficient_attention: false
rescale_loss_with_std: false
energy_loss_ratio: 0.001
force_loss_ratio: 0.0
AutoGradForce: false
seq_only: false
num_force_and_noise_head_layers: 2
psm_validation_mode: false
sample_in_validation: false
num_sampling_time: 1
sampled_structure_output_path: null
psm_finetune_mode: false
psm_sample_structure_in_finetune: false
psm_finetune_reset_head: false
psm_finetune_noise_mode: zero
psm_finetune_valid_noise_mode: T
only_use_rotary_embedding_for_protein: false
psm_validate_for_train_set: false
use_dali_pipeline: false
seed: 12345
fp16: false
fp8: false
auto_cast: false
bf16: false
grad_scaler_init: 1.0
gradient_accumulation_steps: 8
max_tokens: 2048
train_batch_size: 1024
val_batch_size: 1024
val_batch_interval: 0
val_batch_log_interval: 1000
val_batch_log_all_metric: false
val_epoch_interval: 1
save_dir: ''
save_batch_interval: 10000
save_epoch_interval: 1
log_interval: 100
strategy: DDP
pp_partition_layer_name: ''
pp_part_list: null
cpu: false
ifresume: true
load_ckpt: false
freeze_param_list: ''
unfreeze_param_list: ''
finetune_from_checkpoint_dir: null
finetune_from_checkpoint_id: null
reset_act_each_step: false
use_unified_batch_sampler: true
activation_checkpoint_interval: 0
checkpointable_layers: null
gradient_clipping: 1.0
total_num_steps: 500000
warmup_num_steps: 20000
warmup_factor: 0.06
warmup_lr: 1.0e-06
warmup_num_epochs: 10
max_lr: 0.00015
init_lr: 8.0e-05
min_lr: 8.0e-06
weight_decay: 0.0
total_num_epochs: 1000
find_unused_parameters: true
beta1: 0.9
beta2: 0.999
eps: 1.0e-08
dynamic_loader: false
ifstack: false
wandb: true
wandb_team: ai4s-sfm
wandb_group: psm_VT
wandb_project: psm_VT
wandb_run_name: ''
early_stopping: false
early_stopping_patience: 10
early_stopping_metric: valid_loss
early_stopping_mode: min
compile: false
calculate_metrics: false
zero_offload: false
zero_offload_dir: ./
profiling: false
prof_dir: ./prof
ptensorboard: false
allreduce_log_path: /tmp/stragglers
debug: false
local_rank: -1
world_size: 1
node_rank: 0
rank: 0
pipeline_model_parallel_size: 0
tensor_model_parallel_size: 1
deepspeed_config_path: ''
deepspeed_config: ''
dist_backend: nccl
backbone_config:
  model_type: graphormer
backbone: vanillatransformer
