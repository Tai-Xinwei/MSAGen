# -*- coding: utf-8 -*-
import json

from ase import Atoms
from ase.io import write

structure = """
{"source": "mp", "id": 19921, "formula": "(Li2Co(SiO3)2)4", "lattice": [[0.000491, 0.000491, 7.270013], [-9.718217, 3.650977, -0.000428], [-0.00067, -7.304164, -0.000484]], "sites": [{"element": "Li", "fractional_coordinates": [0.71949, 0.83319, 0.189896], "cartesian_coordinates": [-8.096895182959999, 1.655279269276, 5.230253138385999]}, {"element": "Li", "fractional_coordinates": [0.219482, 0.83319, 0.689887], "cartesian_coordinates": [-8.097475680858, -1.9969824971760004, 1.594946482638]}, {"element": "Li", "fractional_coordinates": [0.468604, 0.666533, 0.356126], "cartesian_coordinates": [-6.477520851516999, -0.16747597135899994, 3.406299530744]}, {"element": "Li", "fractional_coordinates": [0.968595, 0.666529, 0.856133], "cartesian_coordinates": [-6.4775714877579995, -3.8193782088340003, 7.040998598951]}, {"element": "Li", "fractional_coordinates": [0.469336, 0.333061, 0.644065], "cartesian_coordinates": [-3.2369601518109996, -3.488127892087, 3.4116245437999995]}, {"element": "Li", "fractional_coordinates": [0.969327, 0.333067, 0.144057], "cartesian_coordinates": [-3.2364379601719997, 0.16427994266799995, 7.046807614986999]}, {"element": "Li", "fractional_coordinates": [0.719017, 0.166379, 0.810628], "cartesian_coordinates": [-1.6170973096559997, -5.313160915362, 5.226799383057]}, {"element": "Li", "fractional_coordinates": [0.219011, 0.166375, 0.310637], "cartesian_coordinates": [-1.616968945764, -1.661404759692, 1.5919912603349997]}, {"element": "Co", "fractional_coordinates": [0.216932, 0.499807, 0.500493], "cartesian_coordinates": [-4.857461700817001, -1.8307925778009995, 1.576642304108]}, {"element": "Co", "fractional_coordinates": [0.96689, 0.999711, 0.999978], "cartesian_coordinates": [-9.715603677556999, -3.653606697755001, 7.0283910039099995]}, {"element": "Co", "fractional_coordinates": [0.71693, 0.499823, 0.000508], "cartesian_coordinates": [-4.857036703321, 1.8214837743890002, 5.211876249973999]}, {"element": "Co", "fractional_coordinates": [0.466882, 0.999697, 0.499969], "cartesian_coordinates": [-9.715378120417, -0.0017555778850000259, 3.393568354154]}, {"element": "Si", "fractional_coordinates": [0.285413, 0.835727, 0.107775], "cartesian_coordinates": [-8.121708410226, 2.2641539179620005, 2.0745463661129997]}, {"element": "Si", "fractional_coordinates": [0.785411, 0.83573, 0.607763], "cartesian_coordinates": [-8.121827057819, -1.387583980121001, 5.709296330611]}, {"element": "Si", "fractional_coordinates": [0.535502, 0.663894, 0.771997], "cartesian_coordinates": [-6.452120263505999, -3.214668039588, 3.892448708346]}, {"element": "Si", "fractional_coordinates": [0.035494, 0.663903, 0.271995], "cartesian_coordinates": [-6.452118230047, 0.43721592360500017, 0.257626045358]}, {"element": "Si", "fractional_coordinates": [0.535268, 0.335708, 0.228603], "cartesian_coordinates": [-3.2623735400579994, -0.4438287995879999, 3.8911509916079994]}, {"element": "Si", "fractional_coordinates": [0.035253, 0.335695, 0.728623], "cartesian_coordinates": [-3.262827724002, -4.096349852934, 0.255793437297]}, {"element": "Si", "fractional_coordinates": [0.285446, 0.163849, 0.892512], "cartesian_coordinates": [-1.5927779662869999, -5.920704935509001, 2.0746940276179995]}, {"element": "Si", "fractional_coordinates": [0.78543, 0.16386, 0.392539], "cartesian_coordinates": [-1.5923043926199998, -2.2685344950460005, 5.709826189633999]}, {"element": "O", "fractional_coordinates": [0.321752, 0.986733, 0.26856], "cartesian_coordinates": [-9.589307370029, 1.6410911845330003, 2.338588918012]}, {"element": "O", "fractional_coordinates": [0.821757, 0.986737, 0.768535], "cartesian_coordinates": [-9.589435723691999, -2.010548105004, 5.973389778464999]}, {"element": "O", "fractional_coordinates": [0.571833, 0.512877, 0.781921], "cartesian_coordinates": [-4.984493097375999, -3.838496318212, 4.156635382709]}, {"element": "O", "fractional_coordinates": [0.071809, 0.512888, 0.281935], "cartesian_coordinates": [-4.984510518926999, -0.18672192754500005, 0.5216963909129999]}, {"element": "O", "fractional_coordinates": [0.571253, 0.48676, 0.218678], "cartesian_coordinates": [-4.730305335957, 0.1801700745510002, 4.152702562857]}, {"element": "O", "fractional_coordinates": [0.071278, 0.486747, 0.718708], "cartesian_coordinates": [-4.730759506961, -3.4724240007950002, 0.5176358042259999]}, {"element": "O", "fractional_coordinates": [0.321839, 0.012923, 0.731464], "cartesian_coordinates": [-0.12592057622199998, -5.295393417376, 2.3394141542869997]}, {"element": "O", "fractional_coordinates": [0.821835, 0.012939, 0.231481], "cartesian_coordinates": [-0.125495581048, -1.643131674496, 5.974633559158999]}, {"element": "O", "fractional_coordinates": [0.128715, 0.832449, 0.946042], "cartesian_coordinates": [-8.090490672507999, -3.8707305671500003, 0.934945550795]}, {"element": "O", "fractional_coordinates": [0.628748, 0.832467, 0.446001], "cartesian_coordinates": [-8.090085056741, -0.21803786263699987, 4.570433973364]}, {"element": "O", "fractional_coordinates": [0.878822, 0.666907, 0.11334], "cartesian_coordinates": [-6.480791381017, 1.607439671981, 6.388707071929999]}, {"element": "O", "fractional_coordinates": [0.378819, 0.666917, 0.613364], "cartesian_coordinates": [-6.481469080739999, -2.0450266196580005, 2.7534367459949998]}, {"element": "O", "fractional_coordinates": [0.378642, 0.332587, 0.387184], "cartesian_coordinates": [-3.232226137437, -1.613602033455, 2.7524025180539997]}, {"element": "O", "fractional_coordinates": [0.878643, 0.332567, 0.887219], "cartesian_coordinates": [-3.232121296056, -5.265767198244, 6.387174279686999]}, {"element": "O", "fractional_coordinates": [0.128779, 0.166868, 0.054154], "cartesian_coordinates": [-1.6216324870469998, 0.213744763269, 0.9361273740869999]}, {"element": "O", "fractional_coordinates": [0.628763, 0.166895, 0.554192], "cartesian_coordinates": [-1.6219844122219995, -3.4382707264400003, 4.570775523930999]}, {"element": "O", "fractional_coordinates": [0.234493, 0.726215, 0.223499], "cartesian_coordinates": [-7.057549566922, 1.0190360482820002, 1.7043481648730001]}, {"element": "O", "fractional_coordinates": [0.734498, 0.726213, 0.723491], "cartesian_coordinates": [-7.057619622672999, -2.6327493179049997, 5.3391490196659985]}, {"element": "O", "fractional_coordinates": [0.484388, 0.773405, 0.997074], "cartesian_coordinates": [-7.516547823957, -4.458870314943, 3.520693455888]}, {"element": "O", "fractional_coordinates": [0.984389, 0.773416, 0.49707], "cartesian_coordinates": [-7.516074221172999, -0.8064734370490001, 7.155949223128999]}, {"element": "O", "fractional_coordinates": [0.484356, 0.226118, 0.003523], "cartesian_coordinates": [-2.1972283332199996, 0.8000568663100002, 3.5211759329919996]}, {"element": "O", "fractional_coordinates": [0.984359, 0.226108, 0.503528], "cartesian_coordinates": [-2.1972206529269998, -2.8518526628069996, 7.155962244891]}, {"element": "O", "fractional_coordinates": [0.234408, 0.273659, 0.777302], "cartesian_coordinates": [-2.6598832440149995, -4.678303476357, 1.7036558670839999]}, {"element": "O", "fractional_coordinates": [0.734412, 0.273667, 0.277304], "cartesian_coordinates": [-2.659380489127, -1.025961374905, 5.338933442744]}], "space_group": {"no": 1, "symbol": "P 1"}}
"""

structure = json.loads(structure)
formula = structure["formula"]
lattice = structure["lattice"]
positions = []
for site in structure["sites"]:
    positions.append(site["fractional_coordinates"])


def convert_to_ascii(fname):
    with open(fname, "r") as f:
        content = f.read()
    with open(fname, "w", encoding="ascii") as f:
        f.write(content)


structure = Atoms(formula, scaled_positions=positions, cell=lattice)
write("structure2.cif", structure, format="cif")
convert_to_ascii("structure2.cif")
